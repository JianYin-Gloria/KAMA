% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data.R
\docType{data}
\name{study.assoc_stats}
\alias{study.assoc_stats}
\title{Example Association Statistics for KAMA}
\format{
A named list of 4 data frames. Each data frame corresponds to a study and contains:
\describe{
\item{chr}{Integer. The chromosome number.}
\item{start, end}{Integer. The start and end position of the genomic region.}
\item{actual_start, actual_end}{Integer. The position of the first and last variant in the region.}
\item{p_value}{Numeric. The P-value from the original association test.}
\item{p_value_kc1 ... p_value_kc5}{Numeric. P-values from 5 Knockoff replicates.}
}
}
\usage{
data(study.assoc_stats)
}
\description{
This dataset contains P-values regarding genomic regions across four studies.
It serves as input for calculating Knockoff statistics (Kappa and Tau) and performing
subsequent meta-analysis and localization.
}
\details{
Association statistics (P-values) from four independent studies, including results
for both original variables and Knockoff replicates.
}
\examples{
# 1. Load data
data(study.assoc_stats)

# Parameters
M <- 5 # number of knockoffs
kappa_list <- list()
tau_list <- list()

# 2. Process each study
for (study in names(study.assoc_stats)) {
  df <- study.assoc_stats[[study]]

  # Extract P-values
  P_0 <- df$p_value
  P_k <- df[, paste0("p_value_kc", 1:M)]

  # Transform P-values to importance scores (larger is better)
  # Using -log10(P) transformation
  T_0 <- -log10(P_0)
  T_k <- -log10(as.matrix(P_k))

  # Calculate KAMA statistics
  stats <- MK.statistic(T_0, T_k)
  kappa_list[[study]] <- stats[, "kappa"]
  tau_list[[study]]   <- stats[, "tau"]
}

# 3. Prepare input matrices
kappa_set <- do.call(cbind, kappa_list)
tau_set   <- do.call(cbind, tau_list)

# Add prefixes to distinguish columns
colnames(kappa_set) <- paste0("kappa_", names(study.assoc_stats))
colnames(tau_set)   <- paste0("tau_", names(study.assoc_stats))

# Extract genetic coordinates from the first study
genetic_info <- study.assoc_stats[[1]][, c("chr", "start", "end", "actual_start", "actual_end")]

# 4. Run Meta-analysis and Localization
meta_res <- KAMA_meta_analysis(kappa_set, tau_set, M = M, genetic_info = genetic_info)

loc_res  <- KAMA_localization(kappa_set, tau_set, M = M, q = 0.1,
                              genetic_info = genetic_info,
                              study_label = names(study.assoc_stats))

print(loc_res)
}
\keyword{datasets}
